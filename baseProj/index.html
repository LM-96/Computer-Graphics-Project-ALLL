<!doctype html>
<html>
  <head>
    <title>FCG Project - Nome Cognome</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <!--per ricaricare sempre la pagina da zero e non usare la cache-->
    <META HTTP-EQUIV=”Pragma” CONTENT=”no-cache”>
    <META HTTP-EQUIV=”Cache-Control” CONTENT=”no-cache”>
    <link rel="stylesheet" href="style.css">
  </head>
<body>


<!-- SHADERS -------------------------------------- da mettere sopra gli altri import -->
<script id="vertex-shader" type="x-shader/x-vertex">
attribute vec4 a_position;
attribute vec3 a_normal;
attribute vec2 a_texcoord;

uniform mat4 u_projection;
uniform mat4 u_view;
uniform mat4 u_world;
uniform vec3 u_viewWorldPosition;

varying vec3 v_normal;
varying vec3 v_surfaceToView;
varying vec2 v_texcoord;

void main() {
  vec4 worldPosition = u_world * a_position;
  gl_Position = u_projection * u_view * worldPosition;
  v_surfaceToView = u_viewWorldPosition - worldPosition.xyz;
  v_normal = mat3(u_world) * a_normal;
  v_texcoord = a_texcoord;
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
precision highp float;

  varying vec3 v_normal;
  varying vec3 v_surfaceToView;
  varying vec2 v_texcoord;

  uniform vec3 diffuse;
  uniform vec3 ambient;
  uniform vec3 emissive;
  uniform vec3 specular;
  uniform float shininess;
  uniform float opacity;
  uniform vec3 u_lightDirection;
  uniform vec3 u_ambientLight;
  uniform vec3 u_colorLight;
  uniform sampler2D diffuseMap;

  void main () {
    vec3 normal = normalize(v_normal);

    vec3 surfaceToViewDirection = normalize(v_surfaceToView);
    vec3 halfVector = normalize(u_lightDirection + surfaceToViewDirection);

    float fakeLight = dot(u_lightDirection, normal) * .5 + .5;
    float specularLight = clamp(dot(normal, halfVector), 0.0, 1.0);

    vec4 diffuseMapColor = texture2D(diffuseMap, v_texcoord);
    vec3 effectiveDiffuse = diffuse * diffuseMapColor.rgb * u_colorLight.rgb;
    float effectiveOpacity = opacity * diffuseMapColor.a;

    gl_FragColor = vec4(
        emissive +
        ambient * u_ambientLight +
        effectiveDiffuse * fakeLight +
        specular * pow(specularLight, shininess),
        effectiveOpacity);
  }
</script>
  <div id="parent_div">

    <canvas width="1500" height="600" id="my_Canvas" class="canvas"></canvas>
    <div class="container">
      <div id="uiContainer" class="menu menuInv">
        <div id="ui">
        </div>
      </div>
      <span class="menuButton" onclick="toggleMenu()">Menu</span>
    </div>

  </div>

<!-- JS Import -->
  <script type="text/javascript" src="./webglUtils/webgl-lessons-ui.js"></script>
  <script type="text/javascript" src="./webglUtils/webgl-utils.js"></script>
  <script type="text/javascript" src="resources/meshx-webglx-utils.js"></script>
  <script type="text/javascript" src="resources/alllUtils.js"></script>
  <script type="text/javascript" src="resources/load_mesh.js"></script>
  <script type="text/javascript" src="resources/glm_utils.js"></script>
  <script type="text/javascript" src="resources/mesh_utils.js"></script>
  <script type="text/javascript" src="./webglUtils/m4.js"></script>

  <script type="text/javascript" src="./myJsScript/menuInterface.js"></script>
  <script type="text/javascript" src="./myJsScript/userInput.js"></script>
  <script type="text/javascript" src="./myJsScript/logutils.js"></script>
  <script type="text/javascript" src="./myJsScript/CanvasEnv.js"></script>
  <script type="text/javascript" src="./myJsScript/controller.js"></script>
  <script type="text/javascript" src="./myJsScript/cameraControls.js"></script>

  <!-- main -->
  <script type="text/javascript" src="main.js"></script>
  <script>
    function toggleMenu(){
      let menu = document.getElementById("uiContainer");
        if(menu.className==="menu menuInv")
          menuVisible(true);
        else
          menuVisible(false);
    }
    function menuVisible(bool) {
      log("Toggle menu:" + bool)
      let menu = document.getElementById("uiContainer");
      if(bool)
        menu.className = "menu";
      else
        menu.className = "menu menuInv";
    }
  </script>
</body>

</html>
