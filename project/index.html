<!doctype html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <!--per ricaricare sempre la pagina da zero e non usare la cache-->
      <META HTTP-EQUIV=”Pragma” CONTENT=”no-cache”>
      <META HTTP-EQUIV=”Cache-Control” CONTENT=”no-cache”>
      <link rel="stylesheet" href="proveCubo.css">
      <link rel="stylesheet" href="public/css/index.css">

      <!-- Bootstrap ------------------------------------------------- -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet">
      <title>Computer Graphics 2021/22</title>
    </head>

<body>

<!-- SHADERS -------------------------------------->
<script id="vertex-shader" type="x-shader/x-vertex">
attribute vec4 a_position;
attribute vec3 a_normal;
attribute vec2 a_texcoord;

uniform mat4 u_projection;
uniform mat4 u_view;
uniform mat4 u_world;
uniform vec3 u_viewWorldPosition;

varying vec3 v_normal;
varying vec3 v_surfaceToView;
varying vec2 v_texcoord;

void main() {
  vec4 worldPosition = u_world * a_position;
  gl_Position = u_projection * u_view * worldPosition;
  v_surfaceToView = u_viewWorldPosition - worldPosition.xyz;
  v_normal = mat3(u_world) * a_normal;
  v_texcoord = a_texcoord;
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
precision highp float;

  varying vec3 v_normal;
  varying vec3 v_surfaceToView;
  varying vec2 v_texcoord;

  uniform vec3 diffuse;
  uniform vec3 ambient;
  uniform vec3 emissive;
  uniform vec3 specular;
  uniform float shininess;
  uniform float opacity;
  uniform vec3 u_lightDirection;
  uniform vec3 u_ambientLight;
  uniform vec3 u_colorLight;
  uniform sampler2D diffuseMap;

  void main () {
    vec3 normal = normalize(v_normal);

    vec3 surfaceToViewDirection = normalize(v_surfaceToView);
    vec3 halfVector = normalize(u_lightDirection + surfaceToViewDirection);

    float fakeLight = dot(u_lightDirection, normal) * .5 + .5;
    float specularLight = clamp(dot(normal, halfVector), 0.0, 1.0);

    vec4 diffuseMapColor = texture2D(diffuseMap, v_texcoord);
    vec3 effectiveDiffuse = diffuse * diffuseMapColor.rgb * u_colorLight.rgb;
    float effectiveOpacity = opacity * diffuseMapColor.a;

    gl_FragColor = vec4(
        emissive +
        ambient * u_ambientLight +
        effectiveDiffuse * fakeLight +
        specular * pow(specularLight, shininess),
        effectiveOpacity);
  }
</script>
<!--
<nav class="navbar navbar-dark bg-dark fixed-right">
  <div class="container-fluid">
    <span class="navbar-brand mb-0 h1">FlowedCamera Settings</span>

      <div class="col-md-2">
        <div class="btn-group" id="camXDiv" role="group" aria-label="Basic example">
          <button type="button" class="btn btn-primary" id="btnCamXInc" onclick="decrementXCam()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-square-fill" viewBox="0 0 16 16">
            <path d="M16 14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12zm-4.5-6.5H5.707l2.147-2.146a.5.5 0 1 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708-.708L5.707 8.5H11.5a.5.5 0 0 0 0-1z"/>
          </button>
          <div class="input-group">
            <div class="input-group-text">X</div>
            <input type="text" disabled="true" id="camXValue" name="camXValue" class="form-control input-number" value="1" min="-100" max="100">
          </div>
          <button type="button" class="btn btn-primary" id="btnCamXDec" onclick="incrementXCam()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square-fill" viewBox="0 0 16 16">
            <path d="M0 14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v12zm4.5-6.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5a.5.5 0 0 1 0-1z"/>
          </svg></button>
        </div>
      </div>

      <div class="col-md-2">
        <div class="btn-group" id="camYDiv" role="group" aria-label="Basic example">
          <button type="button" class="btn btn-primary" id="btnCamY" onclick="decrementYCam()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-square-fill" viewBox="0 0 16 16">
            <path d="M16 14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12zm-4.5-6.5H5.707l2.147-2.146a.5.5 0 1 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708-.708L5.707 8.5H11.5a.5.5 0 0 0 0-1z"/>
          </button>
          <div class="input-group">
            <div class="input-group-text">Y</div>
            <input type="text" disabled="true" id="camYValue" name="camYValue" class="form-control input-number" value="1" min="-100" max="100">
          </div>
          <button type="button" class="btn btn-primary" id="btnCamYDec" onclick="incrementYCam()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square-fill" viewBox="0 0 16 16">
            <path d="M0 14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v12zm4.5-6.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5a.5.5 0 0 1 0-1z"/>
          </svg></button>
        </div>
      </div>

      <div class="col-md-2">
        <div class="btn-group" id="camZDiv" role="group" aria-label="Basic example">
          <button type="button" class="btn btn-primary" id="btnCamZ" onclick="decrementZCam()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-square-fill" viewBox="0 0 16 16">
            <path d="M16 14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12zm-4.5-6.5H5.707l2.147-2.146a.5.5 0 1 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708-.708L5.707 8.5H11.5a.5.5 0 0 0 0-1z"/>
          </button>
          <div class="input-group" >
            <div class="input-group-text">Z</div>
            <input type="text" disabled="true" id="camZValue" name="camZValue" class="form-control input-number" value="1" min="-100" max="100">
          </div>
          <button type="button" class="btn btn-primary" id="btnCamZDec" onclick="incrementZCam()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square-fill" viewBox="0 0 16 16">
            <path d="M0 14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v12zm4.5-6.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5a.5.5 0 0 1 0-1z"/>
          </svg></button>
        </div>
      </div>

      <div class="col-md-3">
        <div class="btn-group" id="camZDiv" role="group" aria-label="Basic example">
          <button type="button" class="btn btn-primary" id="btnCamZ" onclick="decrementFov()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-square-fill" viewBox="0 0 16 16">
            <path d="M16 14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12zm-4.5-6.5H5.707l2.147-2.146a.5.5 0 1 0-.708-.708l-3 3a.5.5 0 0 0 0 .708l3 3a.5.5 0 0 0 .708-.708L5.707 8.5H11.5a.5.5 0 0 0 0-1z"/>
          </button>
          <div class="input-group" >
            <div class="input-group-text">FOV</div>
            <input type="text" disabled="true" id="fovValue" name="fovValue" class="form-control input-number" value="60" min="-520" max="520">
          </div>
          <button type="button" class="btn btn-primary" id="btnCamZDec" onclick="incrementFov()"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-square-fill" viewBox="0 0 16 16">
            <path d="M0 14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v12zm4.5-6.5h5.793L8.146 5.354a.5.5 0 1 1 .708-.708l3 3a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708-.708L10.293 8.5H4.5a.5.5 0 0 1 0-1z"/>
          </svg></button>
        </div>
      </div>

  </div>
</nav> !-->

<div class="center">
  <canvas class="glx-canvas" width="1024" height="512" id="my_Canvas"></canvas>
</div>

<div class="container">
  <div class="accordion" id="mainAccordion">
    <div class="accordion-item">
      <h2 class="accordion-header" id="cameraHeader">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          Camera
        </button>
      </h2>
      <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="cameraHeader" data-bs-parent="#mainAccordion">
        <div class="accordion-body">

          <div class="btn-toolbar mb-3 justify-content-between">

            <!-- CAMERA POSITION -------------------------------------------------------------------------------------->
            <div id="cameraPositionCard" class="card center mt-2 mb-1" >
              <b>Camera Position</b>
              <div class="row m-2">
                <div class="col">
                  <button id="xCamDecBtn" class="btn" type="button"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="xCamInput" type="text" disabled="true" value="0"\>
                  <button id="xCamIncBtn" class="btn" type="button"><img src="resources/images/plus-circle.svg" /></button>
                </div>
                <div class="col">
                  <button id="yCamDecBtn" class="btn" type="button"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="yCamInput" type="text" disabled="true" value="0"\>
                  <button id="yCamIncBtn" class="btn" type="button"><img src="resources/images/plus-circle.svg" /></button>
                </div>
                <div class="col">
                  <button id="zCamDecBtn" class="btn" type="button"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="zCamInput" type="text" disabled="true" value="0"\>
                  <button id="zCamIncBtn" class="btn" type="button"><img src="resources/images/plus-circle.svg" /></button>
                </div>
              </div>
            </div>

            <!-- UP --------------------------------------------------------------------------------------------------->
            <div id="upCard" class="card center mt-2 mb-1" >
              <b>UP</b>
              <div class="row m-2">
                <div class="col">
                  <button id="xUpDecBtn" class="btn" type="button"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="xUpInput" type="text" disabled="true" value="0"\>
                  <button id="xUpIncBtn" class="btn" type="button"><img src="resources/images/plus-circle.svg" /></button>
                </div>
                <div class="col">
                  <button id="yUpDecBtn" class="btn" type="button"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="yUpInput" type="text" disabled="true" value="0"\>
                  <button id="yUpIncBtn" class="btn" type="button"><img src="resources/images/plus-circle.svg" /></button>
                </div>
                <div class="col">
                  <button id="zUpDecBtn" class="btn" type="button"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="zUpInput" type="text" disabled="true" value="0"\>
                  <button id="zUpIncBtn" class="btn" type="button"><img src="resources/images/plus-circle.svg" /></button>
                </div>
              </div>
            </div>

            <!-- TARGET ----------------------------------------------------------------------------------------------->
            <div id="targetCard" class="card center mt-2 mb-1" >
              <b>TARGET</b>
              <div class="row m-2">
                <div class="col">
                  <input class="form-control center mb-1" id="xTargetInput" type="text" value="0"\>
                  <button class="btn btn-primary" type="button" onclick="set('xTarget', document.getElementById('xTargetInput').value)">SET</button>
                </div>
                <div class="col">
                  <input class="form-control center mb-1" id="yTargetInput" type="text" value="0"\>
                  <button class="btn btn-primary" type="button" onclick="set('yTarget', document.getElementById('yTargetInput').value)">SET</button>
                </div>
                <div class="col">
                  <input class="form-control center mb-1" id="zTargetInput" type="text" value="0"\>
                  <button class="btn btn-primary" type="button" onclick="set('zTarget', document.getElementById('zTargetInput').value)">SET</button>
                </div>
              </div>
            </div>

            <!-- FOV -------------------------------------------------------------------------------------------------->
            <div id="fovCard" class="card center mt-2 mb-1" >
              <b>FOV</b>
              <div class="input-group mb-2 p-1">
                <button id="fovDecBtn" class="btn" type="button"><img src="resources/images/dash-circle.svg" /></button>
                <input class="form-control center" id="fovInput" type="text" disabled="true" value="0"\>
                <button id="fovIncBtn" class="btn" type="button"><img src="resources/images/plus-circle.svg" /></button>
              </div>
            </div>

            <!-- CAMERA LOCKS ----------------------------------------------------------------------------------------->
            <div id="cameraLocksCard" class="card center mt-2 mb-1 p-3" >
              <b>FlowedCamera Locks</b>
              <select class="form-select selectpicker meshx-obj-sel" aria-label="Mesh Object List" onchange="onTargetObjectInput(this.value)">
              </select>

              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="lookAtObjectInput" onchange="onLookAtObjectInput(this.checked)">
                <label class="form-check-label" for="lookAtObjectInput">Look at Object</label>
              </div>
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="followTranslationInput" onchange="onFollowObjectTranslationInput(this.checked)">
                <label class="form-check-label" for="followTranslationInput">Follow translation</label>
              </div>
            </div>

            <!-- CAMERA DISTANCE -------------------------------------------------------------------------------------->
            <div id="cameraDistanceCard" class="card center mt-2 mb-1" >
              <b>FlowedCamera Distance from Target</b>
              <div class="row m-2">
                <div class="col">
                  <button class="btn" type="button" onclick="increment('xCamDist',true)"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="xCamDistInput" type="text" disabled="true" value="0"\>
                  <button class="btn" type="button" onclick="increment('xCamDist')"><img src="resources/images/plus-circle.svg" /></button>
                </div>
                <div class="col">
                  <button class="btn" type="button" onclick="increment('yCamDist',true)"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="yCamDistInput" type="text" disabled="true" value="0"\>
                  <button class="btn" type="button" onclick="increment('yCamDist')"><img src="resources/images/plus-circle.svg" /></button>
                </div>
                <div class="col">
                  <button class="btn" type="button" onclick="increment('zCamDist',true)"><img src="resources/images/dash-circle.svg" /></button>
                  <input class="form-control center" id="zCamDistInput" type="text" disabled="true" value="0"\>
                  <button class="btn" type="button" onclick="increment('zCamDist')"><img src="resources/images/plus-circle.svg" /></button>
                </div>
              </div>
            </div>



          </div> <!-- button toolbar -->

        </div>
      </div>
    </div> <!-- accordion item -->

  </div> <!-- accordion !-->
</div> <!-- container !-->

<!-- JS SCRIPT -->
<script type="text/javascript" src="https://unpkg.com/mathjs@11.0.1/lib/browser/math.js"></script>
<script type="text/javascript" src="lib/js/webgl-utils.js"></script>
<script type="text/javascript" src="lib/js/mesh_utils.js"></script>
<script type="text/javascript" src="lib/js/glm_utils.js"></script>
<script type="text/javascript" src="lib/js/load_mesh.js"></script>
<script type="text/javascript" src="lib/js/m4.js"></script>
<script type="text/javascript" src="lib/js/lib-master.js"></script>
<script type="text/javascript" src="dist/bundle.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
<!--<script type="text/javascript" src="movement.js"></script>!-->
</body>

</html>
